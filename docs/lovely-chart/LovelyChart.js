!function(){function t(t,e,n){const o=t,i=e,a=n;function s(t,e,n,i=1){const s=function(t){return t<=13?2*Math.pow(t,2):(t%10||1)*Math.pow(10,Math.floor(t/10)+1)}(n),c=Math.ceil(t.yMin/s)*s,r=Math.floor(t.yMax/s)*s;o.font=f,o.textAlign="left",o.textBaseline="bottom",o.strokeStyle=G(t,"yAxisRulers",i),o.lineWidth=1,o.beginPath();for(let n=c;n<=r;n+=s){const[,s]=e.toPixels(0,n),c=q(i,s);o.fillStyle=G(t,"axesText",c),o.fillText(I(n),l,s-l/2),o.moveTo(l,s),o.lineTo(a.width-l,s)}o.stroke()}return{drawXAxis:function(t,e){o.clearRect(0,a.height-x,n.width,x);const s=a.height-x/2,c=Math.floor(t.xAxisScale),r=function(t){return Math.pow(2,t)}(c),l=1-(t.xAxisScale-c);o.font=f,o.textAlign="center",o.textBaseline="middle";for(let n=t.labelFromIndex;n<=t.labelToIndex;n++){const c=n-p;if(c%r!=0)continue;const d=i.xLabels[n],[u]=e.toPixels(n,0);let h=c%(2*r)==0?1:l;h=H(h,u,a.width),o.fillStyle=G(t,"axesText",h),o.fillText(d.text,u,s)}},drawYAxis:function(t,e){const{yAxisScale:n,yAxisScaleFrom:o,yAxisScaleTo:i,yAxisScaleProgress:a=0}=t;s(t,e,Math.round(o||n),1-a),a>0&&s(t,e,i,a)}}}function e(t,e,i,a,s){const{begin:c,end:r}=i,l=t.xLabels.length-1,d=Math.max(0,Math.ceil(l*c)),u=Math.min(Math.floor(l*r),l),h=t.datasets.filter(({key:t})=>a[t]).map(({values:t})=>t),f=h.map(t=>t.slice(d,u+1)),{min:m=s.yMinFiltered,max:g=s.yMaxFiltered}=O(X(h)),x=m/g>y?m:0,{min:p=s.yMin,max:v=s.yMax}=O(X(f)),M=m/g>y?p:0,b=n(t.xLabels.length,e.width,c,r),E=o(e.height,M,v),w={};return t.datasets.forEach(({key:t})=>{w[`opacity#${t}`]=a[t]?1:0}),Object.assign({xOffset:c*l,xWidth:(r-c)*l,yMinFiltered:x,yMaxFiltered:g,yMin:M,yMax:v,xAxisScale:b,yAxisScale:E,labelFromIndex:Math.max(0,d-1),labelToIndex:Math.min(u+1,l),filter:a},w,function(){const t={};return Object.keys(W.day).forEach(e=>{["R","G","B"].forEach((n,o)=>{t[`colorChannels#${e}#${n}`]=W[document.body.classList.contains("skin-night")?"night":"day"][e][o]})}),t}(),i)}function n(t,e,n,o){const i=t*(o-n),a=Math.floor(e/m);return B(i/a)}function o(t,e,n){const o=t-x,i=n-e,a=Math.floor(o/g);return N(i/a)}window.LovelyChart={create:function(n,o){const f=function(t){const{datasets:e}=function(t){const{columns:e,names:n,colors:o}=t;let i=[];const a=[];return e.forEach(t=>{const e=t.shift();e!==c?a.push({key:e,color:o[e],name:n[e],values:t}):function(t){for(let e=0,n=t.length;e<n;e++)if(void 0!==t[e]&&void 0!==t[e+1]&&t[e]>=t[e+1])throw new Error("Array is not sorted")}(i=t)}),a.forEach(t=>{t.labels=i}),{datasets:a}}(t);let n=1/0,o=-1/0;e.forEach(t=>{const{max:e}=O(t.values);0<n&&(n=0),e>o&&(o=e),t.yMin=0,t.yMax=e});const i=e.map(t=>t.labels[0]),a=e.map(t=>t.labels[t.labels.length-1]),s=Math.min.apply(null,i),r=Math.max.apply(null,a),l=function(t,e){t=R(t),e=R(e);const n=[];for(let o=t;o<=e;o+=$){const t=new Date(o),e=t.getDate(),i=k[t.getMonth()];n.push({value:o,text:`${i} ${e}`})}return n}(s,r);return{datasets:e,yMin:n,yMax:o,xLabels:l}}(o);let m,g,p,y,L,W,j,B;function N(t){const e=F(t,function(){const{width:t,height:e}=y;return{width:t,height:e-x}}(),{xPadding:l,yPadding:u});s(g,p),L.drawYAxis(t,e),function(t,e){const n={from:t.labelFromIndex,to:t.labelToIndex};f.datasets.forEach(({key:o,color:i,values:a})=>{const s={color:i,opacity:t[`opacity#${o}`],lineWidth:h};P(p,a,e,s,n)})}(t,e),L.drawXAxis(t,e),j.update(t),B.update(t,e)}function H(t){W.update({range:t})}function q(t){W.update({filter:t})}return function(t){(m=document.createElement("div")).className="lovely-chart",document.getElementById(t).appendChild(m)}(n),function(){const{canvas:t,context:e}=a(m,{width:m.clientWidth,height:d});p=e,y={width:(g=t).offsetWidth,height:g.offsetHeight}}(),L=t(p,f,y),W=function(t,n,o){const i=t,a=n,s=o,c={begin:0,end:1},r=function(){const t={};return i.datasets.forEach(({key:e})=>{t[e]=!0}),t}(),l=X([S,i.datasets.map(({key:t})=>`opacity#${t}`)]),d=function(t){const e=t,n={};let o=null;function i(t){delete n[t],a()||(cancelAnimationFrame(o),o=null)}function a(){return Boolean(Object.keys(n).length)}function s(){const t={};Object.keys(n).forEach(e=>{const{startedAt:o,from:a,to:s}=n[e],c=Math.min(1,(Date.now()-o)/T),r=a+(s-a)*function(t){return Math.sin(Math.PI/2*t)}(c);n[e].current=r,n[e].progress=c,t[e]=r,1===c&&i(e)}),e(t),a()&&(o=requestAnimationFrame(s))}return{add:function(t,e,i){n[t]={from:e,to:i,current:e,startedAt:Date.now(),progress:0},o||(o=requestAnimationFrame(s))},remove:i,get:function(t){return n[t]},getState:function(){const t={};return Object.keys(n).forEach(e=>{const{current:o,from:i,to:a,progress:s}=n[e];t[e]=o,t[`${e}From`]=i,t[`${e}To`]=a,t[`${e}Progress`]=s}),t},isRunning:a}}(f),u=D(f);let h={};function f(){var t,e;s((t=h,e=d.getState(),new Proxy({},{get:(n,o)=>void 0!==e[o]?e[o]:t[o]})))}return{update:function({range:t={},filter:n={}}={}){Object.assign(c,t),Object.assign(r,n);const o=h;h=e(i,a,c,r,o),l.forEach(t=>{const e=d.get(t),n=e?e.to:o[t];if(void 0!==n&&n!==h[t]){const n=e?e.current:o[t];e&&d.remove(t),d.add(t,n,h[t])}}),d.isRunning()||u()}}}(f,y,N),j=function(t,e,n){const o=t,i=e,c=n;let l,d,u,h,f,m,g,x,p={},y=null;const L=D(function(){const{begin:t,end:e}=p;f.children[0].style.width=`${100*t}%`,f.children[1].style.width=`${100*(e-t)}%`,f.children[2].style.width=`${100*(1-e)}%`});function $(t){g=t.target.offsetLeft}function k(t,e,{dragOffsetX:n}){const o=d.offsetWidth,i=o-m.offsetWidth,a=Math.max(0,Math.min(g+n,i)),s=a+m.offsetWidth,c=a/o,r=s/o;T({begin:c,end:r})}function A(t,e,{dragOffsetX:n}){const o=d.offsetWidth,i=m.offsetLeft+m.offsetWidth-2*E,a=Math.min(i,Math.max(0,g+n)),s=a/o;T({begin:s})}function C(t,e,{dragOffsetX:n}){const o=d.offsetWidth,i=m.offsetLeft+2*E,a=o,s=Math.max(i,Math.min(g+E+n,a)),c=s/o;T({end:c})}function T(t){const e=Object.assign({},p,t);e.begin===p.begin&&e.end===p.end||(p=e,L(),c(p),y&&(clearTimeout(y),y=null),y=setTimeout(()=>{c(p)},50))}return(l=document.createElement("div")).className="minimap",l.style.height=`${v}px`,function(){const{canvas:t,context:e}=a(l,{width:o.offsetWidth-2*M,height:v});d=t,u=e}(),(f=document.createElement("div")).className="ruler",f.innerHTML=w,J(m=f.children[1],{onCapture:$,onDrag:k,draggingCursor:"grabbing"}),J(m.children[0],{onCapture:$,onDrag:A,draggingCursor:"ew-resize"}),J(m.children[1],{onCapture:$,onDrag:C,draggingCursor:"ew-resize"}),l.appendChild(f),o.appendChild(l),h={width:d.offsetWidth,height:d.offsetHeight},T(r),{update:function(t){(function(t){if(!x)return!0;const e=i.datasets.map(({key:t})=>`opacity#${t}`);return e.push("yMaxFiltered"),e.some(e=>x[e]!==t[e])})(t)&&(x=t,s(d,u),function(t={}){i.datasets.forEach(({key:e,color:n,values:o})=>{const a=t[`opacity#${e}`],s={xOffset:0,xWidth:i.xLabels.length-1,yMin:t.yMinFiltered,yMax:t.yMaxFiltered},c=F(s,h,{yPadding:1}),r={color:n,opacity:a,lineWidth:b};P(u,o,c,r,{from:0,to:o.length-1})})}(t))}}}(m,f,H),B=function(t,e,n){const o=t,c=e,r=n;let l,d,u,h,f,m,g;const p=D(M);function y(t){g=t.type.startsWith("touch")?t.touches[0].pageX-t.touches[0].target.getBoundingClientRect().left:t.offsetX,p()}function v(t){t&&t.preventDefault(),g=null,s(h,f),m.classList.remove("shown")}function M(){if(!g||!l)return;const t=g,e=l,{findClosesLabelIndex:n,toPixels:o}=d,a=n(t);if(a<0||a>=c.xLabels.length)return;s(h,f);const[u]=o(a,0);!function(t,e,n){f.strokeStyle=n,f.lineWidth=1,f.beginPath(),f.moveTo(t,0),f.lineTo(t,e),f.stroke()}(u,r.height-x,G(e,"tooltipTail"));const p=c.datasets.filter(({key:t})=>e.filter[t]).map(({name:t,color:e,values:n})=>({name:t,color:e,value:n[a]}));p.forEach(({value:t,color:n})=>{!function([t,e],n,o){f.strokeStyle=n,f.fillStyle=o,f.lineWidth=2,f.beginPath(),f.arc(t,e,4,0,2*Math.PI),f.fill(),f.stroke()}(o(a,t),n,G(e,"bg"))}),function(t,e,n){const o=c.xLabels[n],a=new Date(o.value);m.children[0].innerHTML=`${A[a.getDay()]}, ${o.text}`,m.children[1].innerHTML=t.map(({name:t,color:e,value:n})=>`<div class="dataset" style="color: ${e}"><div>${I(n,2)}</div><div>${t}</div></div>`).join("");const s=Math.max(C+i,Math.min(e,r.width-(m.offsetWidth+i)+C));m.style.left=`${s}px`,m.classList.add("shown")}(p,u,a)}return(u=document.createElement("div")).className="tooltip",function(){const{canvas:t,context:e}=a(u,r);h=t,f=e}(),(m=document.createElement("div")).className="balloon",m.innerHTML='<div class="title"></div><div class="legend"></div>',u.appendChild(m),u.addEventListener("mousemove",y),u.addEventListener("touchmove",y),u.addEventListener("touchstart",y),u.addEventListener("mouseout",v),u.addEventListener("mouseup",v),u.addEventListener("touchend",v),u.addEventListener("touchcancel",v),o.appendChild(u),{update:function(t,e){l=t,d=e,M()}}}(m,f,y),function(t,e,n){const o=t,i=e,a=n;let s;function c(t){t&&(t.preventDefault(),t.currentTarget.classList.toggle("checked"));const e={};Array.from(s.getElementsByTagName("a")).forEach(t=>{e[t.dataset.key]=t.classList.contains("checked")}),a(e)}(s=document.createElement("div")).className="tools",i.datasets.forEach(({key:t,name:e,color:n})=>{const o=document.createElement("a");o.href="#",o.dataset.key=t,o.className="checkbox checked",o.innerHTML=`<span class="circle"></span><span class="label">${e}</span>`,o.firstChild.style.borderColor=n,o.addEventListener("click",c),s.appendChild(o)}),o.appendChild(s),c()}(m,f,q),{redraw:function(){W.update()}}}};const i=1;function a(t,{width:e,height:n}){const o=document.createElement("canvas");o.width=e*L,o.height=n*L,o.style.width="100%",o.style.height=`${n}px`;const i=o.getContext("2d");return i.scale(L,L),t.appendChild(o),{canvas:o,context:i}}function s(t,e){e.clearRect(0,0,t.width,t.height)}const c="x",r={begin:.333,end:.667},l=10,d=320,u=10,h=2,f="300 10px Helvetica, Arial, sans-serif",m=45,g=50,x=30,p=1,y=.5,v=40,M=10,b=1,E=5,w='<div class="mask"></div><div class="slider"><div></div><div></div></div><div class="mask"></div>',L=window.devicePixelRatio||1,$=864e5,k=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],A=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],C=20,T=300,W={day:{bg:[255,255,255],axesText:[150,162,170],yAxisRulers:[242,244,245],tooltipTail:[223,230,235]},night:{bg:[36,47,62],axesText:[84,103,120],yAxisRulers:[41,53,68],tooltipTail:[59,74,90]}},S=["yMax","yMin","xAxisScale","yAxisScale","yMaxFiltered","yMinFiltered",...X(Object.keys(W.day).map(t=>["R","G","B"].map(e=>`colorChannels#${t}#${e}`)))];function F(t,e,{xPadding:n=0,yPadding:o=0}={}){let i=e.width;0===t.begin&&(i-=n),1===t.end&&(i-=n);const a=i/t.xWidth;let s=t.xOffset*a;0===t.begin&&(s-=n);const c=(e.height-o)/(t.yMax-t.yMin),r=t.yMin*c;return{toPixels:(t,n)=>[t*a-s,e.height-(n*c-r)],findClosesLabelIndex:t=>Math.round((t+s)/a)}}function P(t,e,n,o,{from:i,to:a}){t.beginPath();for(let o=i;o<=a;o++){const[a,s]=n.toPixels(o,e[o]);o===i?t.moveTo(a,s):t.lineTo(a,s)}t.save(),t.strokeStyle=o.color,t.lineWidth=o.lineWidth,t.globalAlpha=o.opacity,t.lineJoin="bevel",t.lineCap="butt",t.stroke(),t.restore()}function O(t){const e=t.length;let n=t[0],o=t[0];for(let i=0;i<e;i++){const e=t[i];e>n?n=e:e<o&&(o=e)}return{max:n,min:o}}function X(t){return[].concat.apply([],t)}function D(t){let e=!1;return function(){e||(e=!0,requestAnimationFrame(()=>{e=!1,t()}))}}function R(t){return t-t%$}function I(t,e=1){return t>=1e6?j(t/1e6,e)+"M":t>=1e3?j(t/1e3,e)+"K":t}function j(t,e){return t.toFixed(e).replace(/(\d{3,})\.\d+/,"$1").replace(/\.0+$/,"")}function B(t){return Math.ceil(Math.log2(t))}function N(t){return Math.ceil(t<=288?Math.sqrt(t/2):10*Math.floor(Math.log10(t)-1)+t/Math.pow(10,Math.floor(Math.log10(t))))}function H(t,e,n){const o=Math.min(e+l,n-e);return o<=4*l&&(t=Math.min(1,t,o/(4*l))),t}function q(t,e){return e-l<=2*l?Math.min(1,t,(e-l)/(2*l)):t}function J(t,e){let n=null;function o(o){o.target===t&&(o.preventDefault(),n=o,"mousedown"===o.type?(document.addEventListener("mousemove",a),document.addEventListener("mouseup",i)):"touchstart"===o.type&&(document.addEventListener("touchmove",a),document.addEventListener("touchend",i),document.addEventListener("touchcancel",i),void 0===o.pageX&&(o.pageX=o.touches[0].pageX)),e.draggingCursor&&document.body.classList.add(`cursor-${e.draggingCursor}`),e.onCapture&&e.onCapture(o))}function i(){n&&(e.draggingCursor&&document.body.classList.remove(`cursor-${e.draggingCursor}`),document.removeEventListener("mouseup",i),document.removeEventListener("mousemove",a),document.removeEventListener("touchcancel",i),document.removeEventListener("touchend",i),document.removeEventListener("touchmove",a),n=null)}function a(t){n&&("touchmove"===t.type&&void 0===t.pageX&&(t.pageX=t.touches[0].pageX),e.onDrag(t,n,{dragOffsetX:t.pageX-n.pageX}))}t.addEventListener("mousedown",o),t.addEventListener("touchstart",o)}function G(t,e,n=1){return function([t,e,n],o=1){return`rgba(${t}, ${e}, ${n}, ${o})`}(function(t,e){return["R","G","B"].map(n=>Math.round(t[`colorChannels#${e}#${n}`]))}(t,e),n)}}();