!function(){function t(t,e,n){const o=t,i=e,a=n;function s(t,e,n,i=1){const s=n<=13?2*Math.pow(n,2):(n%10||1)*Math.pow(10,Math.floor(n/10)+1),c=Math.floor(t.yMin/s)*s,r=Math.ceil(t.yMax/s)*s;o.textAlign="left",o.textBaseline="bottom",o.strokeStyle=N(t,"yAxisRulers",i),o.lineWidth=1,o.beginPath();for(let n=c;n<=r;n+=s){const[,s]=e.toPixels(0,n);if(s>a.height-y)continue;let c=i;s-l<=2*l&&(c=Math.min(1,i,(s-l)/(2*l))),o.fillStyle=N(t,"axesText",c),o.fillText(R(n),l,s-l/2),o.moveTo(l,s),o.lineTo(a.width-l,s)}o.stroke()}return{update:function(t,e){o.font=g,function(t,e){const n=a.height-y/2,s=Math.floor(t.xAxisScale),c=Math.pow(2,s),r=1-(t.xAxisScale-s);o.textAlign="center",o.textBaseline="middle";for(let s=Math.floor(t.labelFromIndex)-d;s<=t.labelToIndex+d;s++){if((s-x)%c!=0)continue;const d=i.xLabels[s];if(!d)continue;const[u]=e.toPixels(s,0);let h=(s-x)%(2*c)==0?1:r;const f=Math.min(u+l,a.width-u);f<=4*l&&(h=Math.min(1,h,f/(4*l))),o.fillStyle=N(t,"axesText",h),o.fillText(d.text,u,n)}}(t,e),function(t,e){const{yAxisScale:n,yAxisScaleOriginalFrom:o,yAxisScaleTo:i,yAxisScaleTotalProgress:a}=t;a&&a%1!=0?(s(t,e,o,1-a),s(t,e,i,a)):s(t,e,n)}(t,e)}}}function e(t,e,i,a,s){const{begin:c,end:r}=i,l=t.xLabels.length-1,d=Math.max(0,Math.ceil(l*c)),u=Math.min(l,Math.floor(l*r)),h=t.datasets.filter(({key:t})=>a[t]).map(({values:t})=>t),f=h.map(t=>t.slice(d,u+1)),{min:g=s.yMinFiltered,max:m=s.yMaxFiltered}=O(D(h)),p=g/m>.5?g:0,{min:y=s.yMin,max:x=s.yMax}=O(D(f)),v=g/m>.5?y:0,M=n(t.xLabels.length,e.width,c,r),b=o(e.height,v,x),E={};return t.datasets.forEach(({key:t})=>{E[`opacity#${t}`]=a[t]?1:0}),Object.assign({xOffset:c*l,xWidth:(r-c)*l,yMinFiltered:p,yMaxFiltered:m,yMin:v,yMax:x,xAxisScale:M,yAxisScale:b,labelFromIndex:d,labelToIndex:u,filter:a},E,function(){const t={};return Object.keys(W.day).forEach(e=>{["R","G","B"].forEach((n,o)=>{t[`colorChannels#${e}#${n}`]=W[document.body.classList.contains("skin-night")?"night":"day"][e][o]})}),t}(),i)}function n(t,e,n,o){const i=t*(o-n),a=Math.floor(e/m),s=i/a;return Math.ceil(Math.log2(s))}function o(t,e,n){const o=t-y,i=n-e,a=Math.floor(o/p),s=i/a;return Math.ceil(s<=288?Math.sqrt(s/2):10*Math.floor(Math.log10(s)-1)+s/Math.pow(10,Math.floor(Math.log10(s))))}window.LovelyChart={create:function(n,o){const g=function(t){const{datasets:e}=function(t){const{columns:e,names:n,colors:o}=t;let i=[];const a=[];return e.forEach(t=>{const e=t.shift();e!==c?a.push({key:e,color:o[e],name:n[e],values:t}):function(t){for(let e=0,n=t.length;e<n;e++)if(void 0!==t[e]&&void 0!==t[e+1]&&t[e]>=t[e+1])throw new Error("Array is not sorted")}(i=t)}),a.forEach(t=>{t.labels=i}),{datasets:a}}(t);let n=1/0,o=-1/0;e.forEach(t=>{const{max:e}=O(t.values);0<n&&(n=0),e>o&&(o=e),t.yMin=0,t.yMax=e});const i=e.map(t=>t.labels[0]),a=e.map(t=>t.labels[t.labels.length-1]),s=Math.min.apply(null,i),r=Math.max.apply(null,a),l=function(t,e){t=I(t),e=I(e);const n=[];for(let o=t;o<=e;o+=$){const t=new Date(o),e=t.getDate(),i=k[t.getMonth()];n.push({value:o,text:`${i} ${e}`})}return n}(s,r);return{datasets:e,yMin:n,yMax:o,xLabels:l}}(o);let m,p,x,w,W,j,H,q;function J(t){const e=S(t,function(){const{width:t,height:e}=w;return{width:t,height:e-y}}(),{xPadding:l,yPadding:h});s(p,x),W.update(t,e),function(t,e){const n={from:Math.max(0,t.labelFromIndex-d),to:Math.min(t.labelToIndex+d,g.xLabels.length-1)};g.datasets.forEach(({key:o,color:i,values:a})=>{const s={color:i,opacity:t[`opacity#${o}`],lineWidth:f};P(x,a,e,s,n)})}(t,e),H.update(t),q.update(t,e)}function G(t){j.update({range:t})}function z(t){j.update({filter:t})}return function(t){(m=document.createElement("div")).className="lovely-chart",document.getElementById(t).appendChild(m)}(n),function(){const{canvas:t,context:e}=a(m,{width:m.clientWidth,height:u});x=e,w={width:(p=t).offsetWidth,height:p.offsetHeight}}(),W=t(x,g,w),j=function(t,n,o){const i=t,a=n,s=o,c={begin:0,end:1},r=function(){const t={};return i.datasets.forEach(({key:e})=>{t[e]=!0}),t}(),l=D([F,i.datasets.map(({key:t})=>`opacity#${t}`)]),d=function(t){const e=t,n={};let o=null;function i(t){delete n[t],a()||(cancelAnimationFrame(o),o=null)}function a(){return Boolean(Object.keys(n).length)}function s(){const t={};Object.keys(n).forEach(e=>{const{startedAt:o,from:a,to:s}=n[e],c=Math.min(1,(Date.now()-o)/A),r=a+(s-a)*function(t){return Math.sin(Math.PI/2*t)}(c);n[e].current=r,n[e].progress=c,t[e]=r,1===c&&i(e)}),e(t),a()&&(o=requestAnimationFrame(s))}return{add:function(t,e,i,a){n[t]={from:e,to:i,current:e,origin:a,startedAt:Date.now(),progress:0},o||(o=requestAnimationFrame(s))},remove:i,get:function(t){return n[t]},getState:function(){const t={};return Object.keys(n).forEach(e=>{const{current:o,from:i,to:a,progress:s,origin:c}=n[e];t[e]=o,t[`${e}From`]=i,t[`${e}To`]=a,t[`${e}Progress`]=s,t[`${e}OriginalFrom`]=c?c.from:i,t[`${e}TotalProgress`]=c&&c.progress?(c.progress+s)/(c.progress+1):s}),t},isRunning:a}}(f),u=X(f);let h={};function f(){var t,e;s((t=h,e=d.getState(),new Proxy({},{get:(n,o)=>void 0!==e[o]?e[o]:t[o]})))}return{update:function({range:t={},filter:n={}}={}){Object.assign(c,t),Object.assign(r,n);const o=h;h=e(i,a,c,r,o),l.forEach(t=>{const e=d.get(t),n=e?e.to:o[t];if(void 0!==n&&n!==h[t]){const n=e?e.current:o[t],i=e&&e.origin||e;e&&d.remove(t),d.add(t,n,h[t],i)}}),d.isRunning()||u()}}}(g,w,J),H=function(t,e,n){const o=t,i=e,c=n;let l,d,u,h,f,g,m,p,y={},x=null;const w=X(function(){const{begin:t,end:e}=y;f.children[0].style.width=`${100*t}%`,f.children[1].style.width=`${100*(e-t)}%`,f.children[2].style.width=`${100*(1-e)}%`});function $(t){m=t.target.offsetLeft}function k(t,e,{dragOffsetX:n}){const o=d.offsetWidth,i=o-g.offsetWidth,a=Math.max(0,Math.min(m+n,i)),s=a+g.offsetWidth,c=a/o,r=s/o;A({begin:c,end:r})}function T(t,e,{dragOffsetX:n}){const o=d.offsetWidth,i=g.offsetLeft+g.offsetWidth-2*E,a=Math.min(i,Math.max(0,m+n)),s=a/o;A({begin:s})}function C(t,e,{dragOffsetX:n}){const o=d.offsetWidth,i=g.offsetLeft+2*E,a=o,s=Math.max(i,Math.min(m+E+n,a)),c=s/o;A({end:c})}function A(t){const e=Object.assign({},y,t);e.begin===y.begin&&e.end===y.end||(y=e,w(),c(y),x&&(clearTimeout(x),x=null),x=setTimeout(()=>{c(y)},50))}return(l=document.createElement("div")).className="minimap",l.style.height=`${v}px`,function(){const{canvas:t,context:e}=a(l,{width:o.offsetWidth-2*M,height:v});d=t,u=e}(),(f=document.createElement("div")).className="ruler",f.innerHTML=L,B(g=f.children[1],{onCapture:$,onDrag:k,draggingCursor:"grabbing"}),B(g.children[0],{onCapture:$,onDrag:T,draggingCursor:"ew-resize"}),B(g.children[1],{onCapture:$,onDrag:C,draggingCursor:"ew-resize"}),l.appendChild(f),o.appendChild(l),h={width:d.offsetWidth,height:d.offsetHeight},A(r),{update:function(t){(function(t){if(!p)return!0;const e=i.datasets.map(({key:t})=>`opacity#${t}`);return e.push("yMaxFiltered"),e.some(e=>p[e]!==t[e])})(t)&&(p=t,s(d,u),function(t={}){i.datasets.forEach(({key:e,color:n,values:o})=>{const a=t[`opacity#${e}`],s={xOffset:0,xWidth:i.xLabels.length,yMin:t.yMinFiltered,yMax:t.yMaxFiltered},c=S(s,h,{yPadding:1}),r={color:n,opacity:a,lineWidth:b};P(u,o,c,r)})}(t))}}}(m,g,G),q=function(t,e,n){const o=t,c=e,r=n;let l,d,u,h,f,g,m;const p=X(M);function x(t){m=t.type.startsWith("touch")?t.touches[0].pageX-t.touches[0].target.getBoundingClientRect().left:t.offsetX,p()}function v(t){t&&t.preventDefault(),m=null,s(h,f),g.classList.remove("shown")}function M(){if(!m||!l)return;const t=m,e=l,{findClosesLabelIndex:n,toPixels:o}=d,a=n(t);if(a<0||a>=c.xLabels.length)return;s(h,f);const[u]=o(a,0);!function(t,e,n){f.strokeStyle=n,f.lineWidth=1,f.beginPath(),f.moveTo(t,0),f.lineTo(t,e),f.stroke()}(u,r.height-y,N(e,"tooltipTail"));const p=c.datasets.filter(({key:t})=>e.filter[t]).map(({name:t,color:e,values:n})=>({name:t,color:e,value:n[a]}));p.forEach(({value:t,color:n})=>{!function([t,e],n,o){f.strokeStyle=n,f.fillStyle=o,f.lineWidth=2,f.beginPath(),f.arc(t,e,4,0,2*Math.PI),f.fill(),f.stroke()}(o(a,t),n,N(e,"bg"))}),function(t,e,n){const o=c.xLabels[n],a=new Date(o.value);g.children[0].innerHTML=`${T[a.getDay()]}, ${o.text}`,g.children[1].innerHTML=t.map(({name:t,color:e,value:n})=>`<div class="dataset" style="color: ${e}"><div>${R(n,2)}</div><div>${t}</div></div>`).join("");const s=Math.max(C+i,Math.min(e,r.width-(g.offsetWidth+i)+C));g.style.left=`${s}px`,g.classList.add("shown")}(p,u,a)}return(u=document.createElement("div")).className="tooltip",function(){const{canvas:t,context:e}=a(u,r);h=t,f=e}(),(g=document.createElement("div")).className="balloon",g.innerHTML='<div class="title"></div><div class="legend"></div>',u.appendChild(g),u.addEventListener("mousemove",x),u.addEventListener("touchmove",x),u.addEventListener("touchstart",x),u.addEventListener("mouseout",v),u.addEventListener("mouseup",v),u.addEventListener("touchend",v),u.addEventListener("touchcancel",v),o.appendChild(u),{update:function(t,e){l=t,d=e,M()}}}(m,g,w),function(t,e,n){const o=t,i=e,a=n;let s;function c(t){t&&(t.preventDefault(),t.currentTarget.classList.toggle("checked"));const e={};Array.from(s.getElementsByTagName("a")).forEach(t=>{e[t.dataset.key]=t.classList.contains("checked")}),a(e)}(s=document.createElement("div")).className="tools",i.datasets.forEach(({key:t,name:e,color:n})=>{const o=document.createElement("a");o.href="#",o.dataset.key=t,o.className="checkbox checked",o.innerHTML=`<span class="circle"></span><span class="label">${e}</span>`,o.firstChild.style.borderColor=n,o.addEventListener("click",c),s.appendChild(o)}),o.appendChild(s),c()}(m,g,z),{redraw:function(){j.update()}}}};const i=1;function a(t,{width:e,height:n}){const o=document.createElement("canvas");o.width=e*w,o.height=n*w,o.style.width="100%",o.style.height=`${n}px`;const i=o.getContext("2d");return i.scale(w,w),t.appendChild(o),{canvas:o,context:i}}function s(t,e){e.clearRect(0,0,t.width,t.height)}const c="x",r={begin:.333,end:.667},l=10,d=10,u=320,h=10,f=2,g="300 10px Helvetica, Arial, sans-serif",m=45,p=50,y=30,x=1,v=40,M=10,b=1,E=5,L='<div class="mask"></div><div class="slider"><div></div><div></div></div><div class="mask"></div>',w=window.devicePixelRatio||1,$=864e5,k=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],T=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],C=20,A=300,W={day:{bg:[255,255,255],axesText:[150,162,170],yAxisRulers:[242,244,245],tooltipTail:[223,230,235]},night:{bg:[36,47,62],axesText:[84,103,120],yAxisRulers:[41,53,68],tooltipTail:[59,74,90]}},F=["yMax","yMin","xAxisScale","yAxisScale","yMaxFiltered","yMinFiltered",...D(Object.keys(W.day).map(t=>["R","G","B"].map(e=>`colorChannels#${t}#${e}`)))];function S(t,e,{xPadding:n=0,yPadding:o=0}={}){let i=e.width;0===t.begin&&(i-=n),1===t.end&&(i-=n);const a=i/t.xWidth;let s=t.xOffset*a;0===t.begin&&(s-=n);const c=(e.height-o)/(t.yMax-t.yMin),r=t.yMin*c;return{toPixels:(t,n)=>[t*a-s,e.height-(n*c-r)],findClosesLabelIndex:t=>Math.round((t+s)/a)}}function P(t,e,n,o,i){const{from:a=0,to:s=e.length}=i||{};t.beginPath();for(let o=a;o<=s;o++){const[i,s]=n.toPixels(o,e[o]);o===a?t.moveTo(i,s):t.lineTo(i,s)}t.save(),t.strokeStyle=o.color,t.lineWidth=o.lineWidth,t.globalAlpha=o.opacity,t.lineJoin="bevel",t.lineCap="butt",t.stroke(),t.restore()}function O(t){const e=t.length;let n=t[0],o=t[0];for(let i=0;i<e;i++){const e=t[i];e>n?n=e:e<o&&(o=e)}return{max:n,min:o}}function D(t){return[].concat.apply([],t)}function X(t){let e=!1;return function(){e||(e=!0,requestAnimationFrame(()=>{e=!1,t()}))}}function I(t){return t-t%$}function R(t,e=1){return t>=1e6?j(t/1e6,e)+"M":t>=1e3?j(t/1e3,e)+"K":t}function j(t,e){return t.toFixed(e).replace(/(\d{3,})\.\d+/,"$1").replace(/\.0+$/,"")}function B(t,e){let n=null;function o(o){o.target===t&&(o.preventDefault(),n=o,"mousedown"===o.type?(document.addEventListener("mousemove",a),document.addEventListener("mouseup",i)):"touchstart"===o.type&&(document.addEventListener("touchmove",a),document.addEventListener("touchend",i),document.addEventListener("touchcancel",i),void 0===o.pageX&&(o.pageX=o.touches[0].pageX)),e.draggingCursor&&document.body.classList.add(`cursor-${e.draggingCursor}`),e.onCapture&&e.onCapture(o))}function i(){n&&(e.draggingCursor&&document.body.classList.remove(`cursor-${e.draggingCursor}`),document.removeEventListener("mouseup",i),document.removeEventListener("mousemove",a),document.removeEventListener("touchcancel",i),document.removeEventListener("touchend",i),document.removeEventListener("touchmove",a),n=null)}function a(t){n&&("touchmove"===t.type&&void 0===t.pageX&&(t.pageX=t.touches[0].pageX),e.onDrag(t,n,{dragOffsetX:t.pageX-n.pageX}))}t.addEventListener("mousedown",o),t.addEventListener("touchstart",o)}function N(t,e,n=1){return function([t,e,n],o=1){return`rgba(${t}, ${e}, ${n}, ${o})`}(function(t,e){return["R","G","B"].map(n=>Math.round(t[`colorChannels#${e}#${n}`]))}(t,e),n)}}();